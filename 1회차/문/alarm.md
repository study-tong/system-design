## Alarm service

#### 기본 질문
1. 알림의 도메인을 알아야 할 것 같다. 
	1. 채팅 알람을 말하는 것인지,
	2. 사용자가 구독한 채널이나,
	3. 전체 공지 알람을 말하는 것인지 궁금하다.
2. 어떤 종류의 단말을 지원해야 할지
3. 사용자가 알람을 차단하는 경우 필터링은 어떻게 할지
4. 너무 많은 알람을 보내지 않도록 하는 rate-limit을 고려해야 할지
5. 알람은 FCM이나 APNs같은 제 3자 서비스를 사용하는지


#### 추가 질문
1. 사용자가 온라인으로 접속을 하고 있더라도, 푸시 알림을 전송해야 하는지?
2. 한번 보낸 푸시 알림을 취소도 할 수 있어야 한다면 어떻게 구현하면 좋을까?
3. 사용자가 알람을 확인했는지에 대한 여부를 추적하고 싶으면 어떻게 할 수 있을까?
4. 사용자가 멀티 디바이스를 사용하는 경우 동기화를 할 수 있으면 좋을 것 같다. 이를 어떻게 구현하면 좋을까?
5. 시스템 알람의 경우 거의 모든 사용자에게 한번에 알람을 보내는 경우가 생길 것 같다. 이러한 경우 메세지 큐에 전체 사용자에 대한 알람을 다 발행하면 부하가 커질 것 같다. 어떻게 최적화 할 수 있을까?


#### 더 알아볼 점
1. 작업 서버가 꼭 필요한 이유가 있을까? 알람 서버와 관심사는 어떻게 다른걸까? 
2. 푸시 알람이 실패하는 경우 APN이나 FCM같은 서비스 측에서 Fail을 처리해 줘야 하는 것이 아닌가? 오프라인인 경우 어떻게 처리되는 걸까?
3. FCM과 APNs의 서비스 사용법에 대하여 더 알아보면 좋을 것 같다.
4. 서비스에서 알림 서버로는 어떤 정보를 보내주는 것이 좋을까? 전체 push alarm 데이터 전체와, 발생 했다는 사실 그 자체를 보낼 수도 있을 것 같다. 각각의 장단점이 무엇일까?
#### How to secure hardware spec??

1. **DAU(Daily Active Users)**: 10M(1,000만 명)
2. **피크 트래픽 시간대**: 저녁 6시 ~ 11시, 총 5시간(18,000초)
3. **평균 접속 시간(Session Time)**: 10분(600초)
4. **사용자 요청 빈도**: 10초에 한 번 = 0.1 req/s 

대략적으로 다음 정보가 주어졌을 때, 하드웨어 스펙을 어떻게 구하면 좋을까? 단순하게 계산하면 동시접속자를 계산하고, 사용자의 요청 빈도를 구하여, req/s 를 구할 수 있을 것 같다. 동시 접속자 수는 DAU=10M이 5시간중에 10분을 균일하게 접속한다고 하면, 10M x (10분 / 5시간) = 300K 사용자가 동시접속을 하고, 각 사용자가 초당 0.1의 요청을 보내기 때문에 30K req / s 을 가정할 수 있다. 이때, 1 CPU당 처리할 수 있는 req / s를 알 수 있다면, CPU가 얼마나 필요한지 대략적으로 구할 수 있다.
 하지만 요청마다 계산량이 다르고, 캐시, 데이터베이스 등 추가 고려를 더 해야할 것 같다. 하지만 동시접속자와 req / s 와 데이터의 평균치를 구할 수 있다면, 그에 대한 대략적인 데이터베이스 스펙, 캐시 스펙을 구할 수 있다는 것은 꽤 유용할 것으로 보인다.